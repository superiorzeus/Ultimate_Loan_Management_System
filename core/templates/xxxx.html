// const fetchApplications = async () => {
        //     const applicationsTableBody = document.getElementById('applications-table-body');
        //     applicationsTableBody.innerHTML = '<tr><td colspan="6" class="text-center py-4 text-gray-500">Loading applications...</td></tr>';
        //     try {
        //         const response = await fetch(`${API_BASE_URL}/api/loan-applications/`);
        //         if (!response.ok) {
        //             console.error(`Failed to fetch applications: HTTP Status ${response.status} - ${response.statusText}`);
        //             throw new Error(`Network response was not ok. Status: ${response.status}`);
        //         }
        //         const applications = await response.json();
                
        //         const applicationsHtml = applications.map(app => `
        //             <tr class="transition-colors duration-200 hover:bg-gray-50">
        //                 <td>${app.id}</td>
        //                 <td>${app.user_name}</td>
        //                 <td>${formatCurrency(app.amount)}</td>
        //                 <td class="${app.status === 'approved' ? 'text-green-600' : app.status === 'rejected' ? 'text-red-600' : 'text-yellow-600'} capitalize">${app.status}</td>
        //                 <td>${app.date_created ? new Date(app.date_created).toISOString().slice(0, 10) : 'N/A'}</td>
        //                 <td>
        //                     ${app.status === 'pending' ?
        //                         `<button onclick="approveApplication(${app.id})" class="text-green-600 hover:underline mr-2">Approve</button>
        //                          <button onclick="rejectApplication(${app.id})" class="text-red-600 hover:underline">Reject</button>`
        //                         :
        //                         `<span class="text-gray-500">N/A</span>`
        //                     }
        //                 </td>
        //             </tr>
        //         `).join('');
        //         applicationsTableBody.innerHTML = applicationsHtml || '<tr><td colspan="6" class="text-center py-4 text-gray-500">No applications found.</td></tr>';
        //     } catch (error) {
        //         console.error("Failed to fetch applications:", error);
        //         applicationsTableBody.innerHTML = '<tr><td colspan="6" class="text-center py-4 text-gray-500">Failed to load data.</td></tr>';
        //     }
        // };

        // // New function to handle loan application approval
        // const approveApplication = async (applicationId) => {
        //     const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        //     const url = `${API_BASE_URL}/api/loan-applications/${applicationId}/approve/`;
        //     try {
        //         const response = await fetch(url, {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/json',
        //                 'X-CSRFToken': csrfToken,
        //                 'Authorization': `Token {{ request.user.auth_token.key }}`
        //             }
        //         });
        //         const result = await response.json();
        //         if (response.ok) {
        //             showModal('Success', result.status);
        //             fetchApplications(); // Reload applications table
        //             fetchLoans(); // Also reload loans table to show the new loan
        //         } else {
        //             showModal('Error', result.detail || 'An unexpected error occurred.');
        //         }
        //     } catch (error) {
        //         console.error('Error approving application:', error);
        //         showModal('Error', 'Failed to approve application. Please try again.');
        //     }
        // };

        // // New function to handle loan application rejection
        // const rejectApplication = async (applicationId) => {
        //     const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        //     const url = `${API_BASE_URL}/api/loan-applications/${applicationId}/reject/`;
        //     try {
        //         const response = await fetch(url, {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/json',
        //                 'X-CSRFToken': csrfToken,
        //                 'Authorization': `Token {{ request.user.auth_token.key }}`
        //             }
        //         });
        //         const result = await response.json();
        //         if (response.ok) {
        //             showModal('Success', result.status);
        //             fetchApplications(); // Reload applications table
        //         } else {
        //             showModal('Error', result.detail || 'An unexpected error occurred.');
        //         }
        //     } catch (error) {
        //         console.error('Error rejecting application:', error);
        //         showModal('Error', 'Failed to reject application. Please try again.');
        //     }
        // };

        // // New function to handle loan disbursement
        // const disburseLoan = async (applicationId) => {
        //     const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        //     const url = `${API_BASE_URL}/api/loan-applications/${applicationId}/disburse/`;
        //     try {
        //         const response = await fetch(url, {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/json',
        //                 'X-CSRFToken': csrfToken,
        //                 'Authorization': `Token {{ request.user.auth_token.key }}`
        //             }
        //         });
        //         const result = await response.json();
        //         if (response.ok) {
        //             showModal('Success', result.detail);
        //             fetchApplications(); // Reload applications table
        //             fetchLoans(); // Also reload the loans table
        //         } else {
        //             showModal('Error', result.detail || 'An unexpected error occurred.');
        //         }
        //     } catch (error) {
        //         console.error("Error disbursing loan:", error);
        //         showModal('Error', 'Failed to disburse loan. Please try again.');
        //     }
        // };